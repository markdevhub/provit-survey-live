// src/data/surveyData.js
// Version: Ensures 'diet_describe' has no condition

export const PROVIT_GREEN = '#75C045'; export const PROVIT_BLUE = '#0BABC3'; export const PROVIT_LIGHT_GREEN = '#a8d88a'; export const PROVIT_LIGHT_BLUE = '#6fc8d7'; export const PROVIT_BACKGROUND = '#f8f6f2'; export const PROVIT_TEXT_DARK = '#333333'; export const PROVIT_TEXT_LIGHT = '#555555'; export const PROVIT_BORDER_COLOR = '#e0e0e0'; export const PROVIT_WHITE = '#ffffff'; export const PROVIT_GRADIENT_GREEN = `linear-gradient(105deg, ${PROVIT_LIGHT_GREEN} 0%, ${PROVIT_GREEN} 100%)`; export const PROVIT_GRADIENT_BLUE = `linear-gradient(105deg, ${PROVIT_LIGHT_BLUE} 0%, ${PROVIT_BLUE} 100%)`;
export const SECTIONS = [ { id: 'basics', title: 'Basics' }, { id: 'goals', title: 'Goals' }, { id: 'diet', title: 'Diet' }, { id: 'lifestyle', title: 'Lifestyle' }, ];

export const surveySteps = [
  { id: 'welcome', type: 'welcome', title: 'Nutrition tailored to you.', text: "Let's find the right supplements for your goals, lifestyle, and diet. Get started below!", buttonText: "Let's Get Started" },
  { id: 'name', type: 'text', sectionId: 'basics', question: "What's your first name?", placeholder:"Enter your name", inputKey: 'userName', nextButtonText: 'Next', validation: (v)=>!!v&&v.trim().length>0, validationMessage: "Name required." },
  { id: 'greeting', type: 'info', sectionId: 'basics', autoAdvanceDelay: 1500 },
  { id: 'start-basics', type: 'section-marker', sectionId: 'basics' },
  { id: 'sex', type: 'icon-select', sectionId: 'basics', question: 'What sex were you assigned at birth?', options: [ { id: 'male', text: 'Male', icon: '♂️' }, { id: 'female', text: 'Female', icon: '♀️' } ], inputKey: 'sex', autoAdvance: true },
  { id: 'age', type: 'text', sectionId: 'basics', question: 'How old are you?', placeholder: "Enter age", inputKey: 'age', inputType: 'number', nextButtonText: 'Next', validation: (v)=>!!v&&parseInt(v)>10&&parseInt(v)<120, validationMessage: "Valid age required." },
  { id: 'start-goals', type: 'section-marker', sectionId: 'goals' },
  { id: 'goals', type: 'multi-grid', sectionId: 'goals', question: 'Which areas of your health are you looking to improve?', subText: "Select one or more goals. (Max 5 recommended)", options: [ { id: 'g_sleep', text: 'Sleep', icon: '😴' }, { id: 'g_bones', text: 'Bones', icon: '🦴' }, { id: 'g_joints', text: 'Joints', icon: '🤸' }, { id: 'g_heart', text: 'Heart', icon: '❤️' }, { id: 'g_hair', text: 'Hair', icon: '💇‍' }, { id: 'g_skin', text: 'Skin', icon: '✨' }, { id: 'g_stress', text: 'Stress', icon: '🤯' }, { id: 'g_fitness', text: 'Fitness', icon: '💪' }, { id: 'g_digestion', text: 'Digestion', icon: '🥦' }, { id: 'g_brain', text: 'Brain', icon: '🧠' }, { id: 'g_immunity', text: 'Immunity', icon: '🛡️' }, { id: 'g_energy', text: 'Energy', icon: '⚡️' }, ], inputKey: 'healthGoals', nextButtonText: 'Continue', validation: (v) => Array.isArray(v) && v.length > 0, validationMessage: "Select at least one goal.", },
   { id: 'sluggish', type: 'yes-no-circle', sectionId: 'goals', question: 'Do you often wake up feeling sluggish?', options: [ { id: 'yes', text: 'Yes' }, { id: 'no', text: 'No' } ], inputKey: 'feelsSluggish', autoAdvance: true, condition: (a) => a.healthGoals?.includes('g_sleep') || a.healthGoals?.includes('g_energy') },
   { id: 'bone_history', type: 'yes-no-circle', sectionId: 'goals', question: 'Family history of bone issues (e.g., osteoporosis)?', options: [ { id: 'yes', text: 'Yes' }, { id: 'no', text: 'No' } ], inputKey: 'boneHistory', autoAdvance: true, condition: (a) => a.healthGoals?.includes('g_bones') },
  { id: 'start-diet', type: 'section-marker', sectionId: 'diet' },
  // **** ENSURE NO CONDITION ON THIS STEP ****
  { id: 'diet_describe', sectionId: 'diet', type: 'single-button', question: 'How would you describe your diet?', options: [ { id: 'd_omnivore', text: 'I eat almost everything' }, { id: 'd_plant_based', text: 'Prefer plant-based foods' }, { id: 'd_vegetarian', text: 'Vegetarian' }, { id: 'd_vegan', text: 'Vegan' }, { id: 'd_other', text: 'Other' } ], inputKey: 'dietDescription', autoAdvance: true },
  { id: 'diet_meat', sectionId: 'diet', type: 'single-button', question: 'How often do you eat meat?', options: [ { id: 'meat_never', text: 'Never' }, { id: 'meat_rarely', text: 'Rarely' }, { id: 'meat_1_2_week', text: 'Once/twice per week' }, { id: 'meat_3_plus_week', text: 'Three times per week or more' } ], inputKey: 'meatFrequency', autoAdvance: true, condition: (a) => !['d_vegan', 'd_vegetarian'].includes(a.dietDescription) },
  { id: 'diet_fish', sectionId: 'diet', type: 'single-button', question: 'How often do you eat fish/seafood?', options: [ { id: 'fish_never', text: 'Never' }, { id: 'fish_rarely', text: 'Rarely' }, { id: 'fish_1_week', text: 'Once per week' }, { id: 'fish_2_plus_week', text: 'Twice per week or more' } ], inputKey: 'fishFrequency', autoAdvance: true },
  { id: 'diet_dairy', sectionId: 'diet', type: 'single-button', question: 'How often do you eat dairy?', options: [ { id: 'dairy_never', text: 'Never' }, { id: 'dairy_rarely', text: 'Rarely' }, { id: 'dairy_1_2_week', text: 'Once/twice per week' }, { id: 'dairy_3_plus_week', text: 'Three times per week or more' } ], inputKey: 'dairyFrequency', autoAdvance: true },
  { id: 'diet_veg', sectionId: 'diet', type: 'single-button', question: 'Daily fruit/veg serves?', options: [ { id: 'veg_0', text: 'Almost none' }, { id: 'veg_1_2', text: '1-2 serves' }, { id: 'veg_3_plus', text: '3 serves or more' } ], inputKey: 'vegServings', autoAdvance: true },
  { id: 'diet_restrictions', sectionId: 'diet', type: 'checkbox', question: 'Any diet restrictions or preferences?', subText: "Select all that apply.", options: [ { id: 'dr_dairy', text: 'Limiting dairy' }, { id: 'dr_gluten', text: 'Gluten free' }, { id: 'dr_paleo', text: 'Paleo' }, { id: 'dr_none', text: 'None', exclusive: true } ], inputKey: 'dietRestrictions', nextButtonText: 'Continue' },
  { id: 'allergies', sectionId: 'diet', type: 'checkbox', question: 'Are you allergic to any of the following?', subText: 'Select all known allergies, if any.', options: [ { id: 'al_none', text: 'None', exclusive: true }, {id: 'al_fish', text: 'Fish'}, { id: 'al_gluten', text: 'Gluten/Wheat' }, {id: 'al_milk', text: 'Milk'}, { id: 'al_soy', text: 'Soy' }, {id: 'al_sulphites', text: 'Sulphites'}, { id: 'al_yeast', text: 'Yeast' }, {id: 'al_corn', text: 'Corn/Maize'}, { id: 'al_treenuts', text: 'Tree nuts' }, {id: 'al_peanuts', text: 'Peanuts'}, { id: 'al_egg', text: 'Egg' }, {id: 'al_sesame', text: 'Sesame'} ], inputKey: 'allergies', nextButtonText: 'Continue', gridColumns: 2 },
  { id: 'start-lifestyle', type: 'section-marker', sectionId: 'lifestyle' },
  { id: 'exercise', sectionId: 'lifestyle', type: 'single-button', question: 'Avg weekly exercise days?', options: [ { id: 'ex_0', text: "I don't exercise" }, { id: 'ex_1', text: '1' }, { id: 'ex_2_3', text: '2-3' }, { id: 'ex_4_plus', text: '4 or more' } ], inputKey: 'exerciseFrequency', autoAdvance: true },
  { id: 'sunshine', sectionId: 'lifestyle', type: 'single-button', question: 'How often 20min sunshine (no sunscreen)?', options: [ { id: 'sun_rarely', text: "Rarely, I don't really get in the sun" }, { id: 'sun_weekends', text: 'On weekends and holidays only' }, { id: 'sun_daily', text: 'Every day!' } ], inputKey: 'sunExposure', autoAdvance: true },
  { id: 'alcohol', sectionId: 'lifestyle', type: 'yes-no-circle', question: 'Consume 8+ alcoholic drinks/week often?', options: [ { id: 'yes', text: 'Yes' }, { id: 'no', text: 'No' } ], inputKey: 'highAlcohol', autoAdvance: true },
  { id: 'smoking', sectionId: 'lifestyle', type: 'yes-no-circle', question: 'Do you smoke?', subText: "May affect nutrient absorption.", options: [ { id: 'yes', text: 'Yes' }, { id: 'no', text: 'No' } ], inputKey: 'isSmoker', autoAdvance: true },
  { id: 'email', type: 'email', sectionId: 'finish', question: 'Which email address should we use?', subText: "Save progress & get recommendations.", placeholder: "Enter email", inputKey: 'email', buttonText: 'See My Results', validation:(v)=> /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v||""), validationMessage:"Invalid email", consentInputKey: 'hasConsented', consentText: "Agree to <a href='/privacy-policy' target='_blank'>Privacy Policy</a> & terms."},
  { id: 'loading', type: 'loading' },
  { id: 'results', type: 'results' }
];
export const getProgressSteps = (allSteps) => allSteps.filter(step => step.id !== 'welcome' && !['loading','results','info','section-header','section-marker'].includes(step.type) );